{% extends "global/base.html" %}

{% block texto %}
    <main class="container p-3 mb-2 bg-secondary-subtle text-secondary-emphasis">
        <div class="p-5 invisible"></div>
        <section>
            <div class="overflow-auto">
                <form method="post" action="{% url 'editar' 0 %}">
                    <table class="table table-striped table-boarded">
                        <thead>
                            <tr>
                                <th scope="col">Selecionar</th>
                                <th scope="col">ID</th>
                                <th scope="col">Nome</th>
                                <th scope="col">Sobrenome</th>
                                <th scope="col">Sexo</th>
                                <th scope="col">CEP</th>
                                <th scope="col">Rua</th>
                                <th scope="col">NÂ°</th>
                                <th scope="col">Complemento</th>
                                <th scope="col">Bairro</th>
                                <th scope="col">Cidade</th>
                                <th scope="col">UF</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for usuario in usuarios %}
                            <tr>
                                <td><input type="radio" name="select_usuario" value="{{ usuario.id }}"></td>
                                <td>{{ usuario.id }}</td>
                                <td>{{ usuario.nome }}</td>
                                <td>{{ usuario.sobrenome }}</td>
                                <td>{{ usuario.sexo }}</td>
                                <td>{{ usuario.cep }}</td>
                                <td>{{ usuario.rua }}</td>
                                <td>{{ usuario.numero }}</td>
                                <td>{{ usuario.complemento }}</td>
                                <td>{{ usuario.bairro }}</td>
                                <td>{{ usuario.cidade }}</td>
                                <td>{{ usuario.uf }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <div class="mt-3 text-end">
                        <button type="submit" class="btn btn-primary" id="editar" disabled>Editar</button>
                        <button type="button" class="btn btn-danger" id="apagar" disabled>Apagar</button>
                    </div>
                </form>
                <script>
                    const radios = document.querySelectorAll('input[name="select_usuario"]');
                    const editar = document.getElementById('editar');
                    const apagar = document.getElementById('apagar');

                    radios.forEach(radio => {
                        radio.addEventListener('change', () => {
                            const selected = Array.from(radios).some(radio => radio.checked);
                            editar.disabled = !selected;
                            apagar.disabled = !selected;
                            if (selected) {
                                editar.setAttribute('formaction', `{% url 'editar' %}`.replace('0', radio.value));
                            }
                        });
                    });
                </script>
            </div>
        </section>
    </main>
{% endblock texto %}
